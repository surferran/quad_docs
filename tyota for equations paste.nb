(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     73111,       2171]
NotebookOptionsPosition[     72046,       2135]
NotebookOutlinePosition[     72388,       2150]
CellTagsIndexPosition[     72345,       2147]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalX]", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SubscriptBox["x", "p"], "[", "t", "]"}]},
      {
       RowBox[{
        SubscriptBox["y", "p"], "[", "t", "]"}]},
      {
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}]}
     }], ")"}]}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"already", " ", 
     RowBox[{"here", " ", ":", " ", 
      RowBox[{"replacing", " ", 
       StyleBox["all",
        FontWeight->"Plain"], " ", "former", " ", 
       SubscriptBox["h", "p"]}]}]}], ",", 
    RowBox[{
     SubscriptBox["l", "p"], " ", "with", " ", "new", " ", "2", 
     SubscriptBox["h", "p"]}], ",", 
    RowBox[{"2", 
     SubscriptBox["l", "p"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["h", "p"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"], 
      "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
          SubscriptBox["h", "p"]}], "+", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"]}],
      ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["h", "p"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"], 
      "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
          SubscriptBox["h", "p"]}], "-", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"]}],
      ")"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[ScriptCapitalV]", "1"], "=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["h", "p"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["l", "p"]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
     {
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
         SubscriptBox["h", "p"]}], "+", " ", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["l", "p"]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "1"], "[", "t", "]"}], "-", " ", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "1"], "[", "t", "]"}], "-", " ", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}]}
    }], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[ScriptCapitalV]", "2"], "=", 
  RowBox[{"(", GridBox[{
     {
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["h", "p"]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["l", "p"]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
     {
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
         SubscriptBox["h", "p"]}], "-", " ", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         SubscriptBox["l", "p"]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
          RowBox[{
           SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "2"], "[", "t", "]"}], "-", " ", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               SubscriptBox["y", "2"], "[", "t", "]"}]}], "+", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "2"], "[", "t", "]"}], "-", " ", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}]}
    }], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"EOM", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[ScriptCapitalX]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", GridBox[{
           {"1", "0", "0"},
           {"0", "1", "0"},
           {"0", "0", 
            RowBox[{"-", "\[Alpha]"}]}
          }], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["1", "A"]}], ")"}]}], ")"}], ".", 
      SubscriptBox["\[ScriptCapitalV]", "1"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Kappa]", 
        RowBox[{"(", GridBox[{
           {"1", "0", "0"},
           {"0", "1", "0"},
           {"0", "0", 
            RowBox[{"-", "\[Alpha]"}]}
          }], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           FractionBox["1", "B"], "\[ScriptCapitalL]"}]}], ")"}]}], ")"}], 
      ".", 
      SubscriptBox["\[ScriptCapitalV]", "2"]}], "-", 
     RowBox[{"(", GridBox[{
        {"0"},
        {"\[Gamma]"},
        {"0"}
       }], ")"}]}]}], "//", "Flatten"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHbFNVX/xmteOTBe9jUB0qdZp7oNAmoXNUxlEH59l
bA+ir9uGuoNorsCVoSB6xZllqSC6bZteNYj2OWzRAqJ3bKroAtEBjA49IPpk
1qwJILrmwd3JIFrm9bUVIHpT7qO9IPrylx2HQLT7u9ajIPpc4f7rYHuWrrgB
ojmvhz8A0U0Foj9BtMonO9ZDQLorzp4XRBfvyhEG0XmXI0VBtMn3WikQfcrz
GZgWMVDQBdFtfwz1QLSDn8rnU0Ba/VEOmH7z4O0vEH2pv/Q3iP62yW7+JSC9
eEolmD53kWc5iLYpywXTfExxq0H0n4X71oHoqM7ndz3WvnYM6pF5DqJFtI3f
g+gbr62/gWgATJnLqQ==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "p"], "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["y", "p"], "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.7147299065085516`*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["h", "p"]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["l", "p"]}], "+", 
      RowBox[{
       SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
       SubscriptBox["h", "p"]}], "+", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["l", "p"]}], "+", 
      RowBox[{
       SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.7147299065125513`*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["h", "p"]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["l", "p"]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
       SubscriptBox["h", "p"]}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
       SubscriptBox["l", "p"]}], "+", 
      RowBox[{
       SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
      RowBox[{
       SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.7147299065125513`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["h", "p"]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["l", "p"]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
     RowBox[{
      SubscriptBox["x", "p"], "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
      SubscriptBox["h", "p"]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["l", "p"]}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
     RowBox[{
      SubscriptBox["y", "p"], "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["l", "p"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      SubscriptBox["h", "p"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.7147299065165515`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["h", "p"]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["l", "p"]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
     RowBox[{
      SubscriptBox["x", "p"], "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
      SubscriptBox["h", "p"]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
      SubscriptBox["l", "p"]}], "+", 
     RowBox[{
      SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
     RowBox[{
      SubscriptBox["y", "p"], "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["h", "p"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{
      SubscriptBox["l", "p"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
           RowBox[{
            SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["y", "2"], "[", "t", "]"}]}], "+", 
           RowBox[{
            SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.7147299065205517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["x", "p"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["y", "p"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Theta]", "p"], "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "}"}]}], "}"}], "\[Equal]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["h", "p"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{
          SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
         RowBox[{
          SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}]}], "+", 
      RowBox[{"\[Kappa]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["h", "p"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{
          SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
         RowBox[{
          SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["\[ScriptCapitalL]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Gamma]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
          SubscriptBox["h", "p"]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{
          SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
         RowBox[{
          SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"\[Kappa]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["\[ScriptCapitalL]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
          SubscriptBox["h", "p"]}], "-", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
          SubscriptBox["l", "p"]}], "+", 
         RowBox[{
          SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
         RowBox[{
          SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Alpha]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["l", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               RowBox[{
                SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SubscriptBox["h", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["1", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "+", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}]}], "-", 
      RowBox[{"\[Alpha]", " ", "\[Kappa]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox["\[ScriptCapitalL]", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                   SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], 
                " ", 
                SubscriptBox["h", "p"]}], "-", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
                SubscriptBox["l", "p"]}], "+", 
               RowBox[{
                SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}], "2"]}]]]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["h", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SubscriptBox["l", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 SubscriptBox["y", "2"], "[", "t", "]"}]}], "+", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{{3.714729894224367*^9, 3.714729906532552*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalX]", "/.", 
   RowBox[{
    RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["h", "p"]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"],
         "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
            SubscriptBox["h", "p"]}], "+", " ", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], 
         "2"]}], ")"}]}], "/.", 
     RowBox[{
      RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
    "TraditionalForm"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["h", "p"]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], "2"],
         "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
            SubscriptBox["h", "p"]}], "-", " ", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
             RowBox[{
              SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}], 
         "2"]}], ")"}]}], "/.", 
     RowBox[{
      RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
    "TraditionalForm"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[ScriptCapitalV]", "1"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["h", "p"]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["l", "p"]}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["x", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
       {
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
           SubscriptBox["h", "p"]}], "+", " ", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["l", "p"]}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["l", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", 
               RowBox[{
                SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", " ", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SubscriptBox["h", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "1"], "[", "t", "]"}], "-", " ", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "1"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}]}
      }], ")"}], "/.", 
    RowBox[{
     RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
   "TraditionalForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["\[ScriptCapitalV]", "2"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["h", "p"]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["l", "p"]}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["x", "2"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
       {
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}]}], " ", 
           SubscriptBox["h", "p"]}], "-", " ", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{
             SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
           SubscriptBox["l", "p"]}], "+", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
            RowBox[{
             SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}], ")"}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["l", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", " ", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 SubscriptBox["y", "2"], "[", "t", "]"}]}], "+", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
          "+", 
         RowBox[{
          SubscriptBox["h", "p"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], 
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{
                SubscriptBox["x", "2"], "[", "t", "]"}], "-", " ", 
               RowBox[{
                SubscriptBox["x", "p"], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{
               SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox["y", "2"], "[", "t", "]"}], "-", 
               RowBox[{
                SubscriptBox["y", "p"], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}]}]}]}
      }], ")"}], "/.", 
    RowBox[{
     RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
   "TraditionalForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EOM", "/.", 
   RowBox[{
    RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.714729918580843*^9, 3.714729944961937*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["x", "p"]},
     {
      SubscriptBox["y", "p"]},
     {
      SubscriptBox["\[Theta]", "p"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.7147299459220257`*^9}],

Cell[BoxData[
 FormBox[
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"cos", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "-", 
       SubscriptBox["x", "p"], "+", 
       SubscriptBox["x", "1"]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"cos", "(", 
           SubscriptBox["\[Theta]", "p"], ")"}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "-", 
       SubscriptBox["y", "p"], "+", 
       SubscriptBox["y", "1"]}], ")"}], "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.714729945930026*^9}],

Cell[BoxData[
 FormBox[
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "-", 
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"cos", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "-", 
       SubscriptBox["x", "p"], "+", 
       SubscriptBox["x", "2"]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{"cos", "(", 
           SubscriptBox["\[Theta]", "p"], ")"}]}], ")"}]}], "-", 
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}]}], "-", 
       SubscriptBox["y", "p"], "+", 
       SubscriptBox["y", "2"]}], ")"}], "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.71472994597003*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["h", "p"]}], "+", 
       RowBox[{
        RowBox[{"cos", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["l", "p"]}], "+", 
       SubscriptBox["x", "1"], "-", 
       SubscriptBox["x", "p"]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"cos", "(", 
          SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
        SubscriptBox["h", "p"]}], "+", 
       RowBox[{
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["l", "p"]}], "+", 
       SubscriptBox["y", "1"], "-", 
       SubscriptBox["y", "p"]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"cos", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["y", "1"], "-", 
             SubscriptBox["y", "p"]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"sin", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "1"], "-", 
             SubscriptBox["x", "p"]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"cos", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "1"], "-", 
             SubscriptBox["x", "p"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"sin", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["y", "1"], "-", 
             SubscriptBox["y", "p"]}], ")"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.714729945974028*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["h", "p"]}], "-", 
       RowBox[{
        RowBox[{"cos", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["l", "p"]}], "+", 
       SubscriptBox["x", "2"], "-", 
       SubscriptBox["x", "p"]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"cos", "(", 
          SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
        SubscriptBox["h", "p"]}], "-", 
       RowBox[{
        RowBox[{"sin", "(", 
         SubscriptBox["\[Theta]", "p"], ")"}], " ", 
        SubscriptBox["l", "p"]}], "+", 
       SubscriptBox["y", "2"], "-", 
       SubscriptBox["y", "p"]}]},
     {
      RowBox[{
       RowBox[{
        SubscriptBox["h", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"cos", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "2"], "-", 
             SubscriptBox["x", "p"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"sin", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["y", "2"], "-", 
             SubscriptBox["y", "p"]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SubscriptBox["l", "p"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"sin", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["x", "2"], "-", 
             SubscriptBox["x", "p"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"cos", "(", 
            SubscriptBox["\[Theta]", "p"], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["y", "p"], "-", 
             SubscriptBox["y", "2"]}], ")"}]}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.714729945978028*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SuperscriptBox[
        SubscriptBox["x", "p"], "\[Prime]\[Prime]",
        MultilineFunction->None]},
      {
       SuperscriptBox[
        SubscriptBox["y", "p"], "\[Prime]\[Prime]",
        MultilineFunction->None]},
      {
       SuperscriptBox[
        SubscriptBox["\[Theta]", "p"], "\[Prime]\[Prime]",
        MultilineFunction->None]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
   "\[LongEqual]", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"sin", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["h", "p"]}], "+", 
           RowBox[{
            RowBox[{"cos", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           SubscriptBox["x", "1"], "-", 
           SubscriptBox["x", "p"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["1", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "1"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "1"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}]}], "+", 
        RowBox[{"\[Kappa]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"sin", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["h", "p"]}], "-", 
           RowBox[{
            RowBox[{"cos", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           SubscriptBox["x", "2"], "-", 
           SubscriptBox["x", "p"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["\[ScriptCapitalL]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "2"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "2"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"-", "\[Gamma]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["1", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "1"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "1"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"cos", "(", 
              SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
            SubscriptBox["h", "p"]}], "+", 
           RowBox[{
            RowBox[{"sin", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           SubscriptBox["y", "1"], "-", 
           SubscriptBox["y", "p"]}], ")"}]}], "+", 
        RowBox[{"\[Kappa]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["\[ScriptCapitalL]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "2"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "2"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"cos", "(", 
              SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
            SubscriptBox["h", "p"]}], "-", 
           RowBox[{
            RowBox[{"sin", "(", 
             SubscriptBox["\[Theta]", "p"], ")"}], " ", 
            SubscriptBox["l", "p"]}], "+", 
           SubscriptBox["y", "2"], "-", 
           SubscriptBox["y", "p"]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["l", "p"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"cos", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "1"], "-", 
                 SubscriptBox["y", "p"]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"sin", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "1"], "-", 
                 SubscriptBox["x", "p"]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["h", "p"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"cos", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "1"], "-", 
                 SubscriptBox["x", "p"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"sin", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "1"], "-", 
                 SubscriptBox["y", "p"]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["1", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "1"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "+", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "1"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}]}], "-", 
        RowBox[{"\[Alpha]", " ", "\[Kappa]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["\[ScriptCapitalL]", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"cos", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["x", "2"], "-", 
                 SubscriptBox["x", "p"]}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"cos", "(", 
                    SubscriptBox["\[Theta]", "p"], ")"}]}], " ", 
                  SubscriptBox["h", "p"]}], "-", 
                 RowBox[{
                  RowBox[{"sin", "(", 
                   SubscriptBox["\[Theta]", "p"], ")"}], " ", 
                  SubscriptBox["l", "p"]}], "+", 
                 SubscriptBox["y", "2"], "-", 
                 SubscriptBox["y", "p"]}], ")"}], "2"]}]]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["h", "p"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"cos", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "2"], "-", 
                 SubscriptBox["x", "p"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"sin", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "2"], "-", 
                 SubscriptBox["y", "p"]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["l", "p"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"sin", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["x", "2"], "-", 
                 SubscriptBox["x", "p"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"cos", "(", 
                SubscriptBox["\[Theta]", "p"], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["y", "p"], "-", 
                 SubscriptBox["y", "2"]}], ")"}]}]}], ")"}]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.7147299459860287`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["\[Theta]", "p"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      SubscriptBox["\[Theta]", "p"], "0"], "+", 
     RowBox[{"\[Delta]\[Theta]", "[", "t", "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["x", "p"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      SubscriptBox["x", "p"], "0"], "+", 
     RowBox[{"\[Delta]x", "[", "t", "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
  "TraditionalForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["y", "p"], "[", "t", "]"}], "\[Rule]", 
    RowBox[{
     SubscriptBox[
      SubscriptBox["y", "p"], "0"], "+", 
     RowBox[{"\[Delta]y", "[", "t", "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"a_", "[", "t", "]"}], "\[Rule]", "a"}]}], "//", 
  "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.714731154234889*^9, 3.7147311558289475`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[Theta]", "p"], "\[Rule]", 
   RowBox[{"\[Delta]\[Theta]", "+", 
    SubscriptBox[
     SubscriptBox["\[Theta]", "p"], "0"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7147311562162066`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["x", "p"], "\[Rule]", 
   RowBox[{"\[Delta]x", "+", 
    SubscriptBox[
     SubscriptBox["x", "p"], "0"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.7147311562182074`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["y", "p"], "\[Rule]", 
   RowBox[{"\[Delta]y", "+", 
    SubscriptBox[
     SubscriptBox["y", "p"], "0"]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.714731156219207*^9}]
}, Open  ]]
},
WindowSize->{1350, 685},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 11683, 358, 357, "Input"],
Cell[12266, 382, 395, 12, 33, "Output"],
Cell[12664, 396, 1220, 38, 56, "Output"],
Cell[13887, 436, 1220, 38, 56, "Output"],
Cell[15110, 476, 2816, 89, 55, "Output"],
Cell[17929, 567, 2817, 89, 55, "Output"],
Cell[20749, 658, 16661, 459, 714, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37447, 1122, 10754, 315, 255, "Input"],
Cell[48204, 1439, 685, 21, 83, "Output"],
Cell[48892, 1462, 1010, 32, 70, "Output"],
Cell[49905, 1496, 1009, 32, 70, "Output"],
Cell[50917, 1530, 2555, 78, 92, "Output"],
Cell[53475, 1610, 2555, 78, 92, "Output"],
Cell[56033, 1690, 14084, 373, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70154, 2068, 1149, 37, 77, "Input"],
Cell[71306, 2107, 254, 7, 48, "Output"],
Cell[71563, 2116, 233, 7, 48, "Output"],
Cell[71799, 2125, 231, 7, 48, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
