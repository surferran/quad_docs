(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42728,       1100]
NotebookOptionsPosition[     41587,       1060]
NotebookOutlinePosition[     42081,       1080]
CellTagsIndexPosition[     42038,       1077]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["quad diagram", "Text",
 CellChangeTimes->{{3.7120586010605593`*^9, 3.7120586076359143`*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.712280031893667*^9, 3.7122800336057043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawSystem", "[", "\[Theta]p_", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"geometric", " ", 
     RowBox[{"properties", ":"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["l", "p"], "=", "2"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"length", " ", "of", " ", "payload", " ", "box"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["h", "p"], "=", "1"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"hight", " ", "of", " ", "payload", " ", "box"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["l", "1"], "=", 
        SqrtBox["25"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["l", "2"], "=", 
        SqrtBox["25"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["m", "1"], "=", "1"}], ",", 
       RowBox[{
        SubscriptBox["m", "2"], "=", "1"}], ",", 
       RowBox[{
        SubscriptBox["m", "p"], "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["k", "1"], "=", 
        RowBox[{"1", "/", "100."}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["k", "2"], "=", 
        RowBox[{"1.", "/", "100"}]}]}], "\[IndentingNewLine]", "}"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"(*", 
       RowBox[{"for", " ", "lumped", " ", "mass"}], "*)"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["l", "p"], "=", "0"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"length", " ", "of", " ", "payload", " ", "box"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["h", "p"], "=", "0"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"hight", " ", "of", " ", "payload", " ", "box"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["l", "1"], "=", 
         SqrtBox["25"]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["l", "2"], "=", 
         SqrtBox["25"]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["m", "1"], "=", "1"}], ",", 
        RowBox[{
         SubscriptBox["m", "2"], "=", "1"}], ",", 
        RowBox[{
         SubscriptBox["m", "p"], "=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["k", "1"], "=", 
         RowBox[{"1", "/", "100."}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["k", "2"], "=", 
         RowBox[{"0", " ", 
          RowBox[{"1.", "/", "100"}]}]}]}], "\[IndentingNewLine]", "}"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"initial", " ", 
       RowBox[{"locations", ":"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"scale0", " ", "=", " ", "10"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "1"], "=", "0"}], ",", 
         RowBox[{
          SubscriptBox["z", "1"], "=", "scale0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "2"], "=", "scale0"}], ",", 
         RowBox[{
          SubscriptBox["z", "2"], "=", "scale0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "p"], "=", 
          RowBox[{"scale0", "/", "2"}]}], ",", 
         RowBox[{
          SubscriptBox["z", "p"], "=", 
          RowBox[{"scale0", "/", "2"}]}], ",", 
         RowBox[{
          SubscriptBox["\[Theta]", "p"], "=", 
          RowBox[{"\[Theta]p", " ", "Degree"}]}]}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", "Orientation", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rp2I", "=", 
        RowBox[{"(", 
         RowBox[{"RotationMatrix", "[", 
          SubscriptBox["\[Theta]", "p"], "]"}], ")"}]}], ")"}], "//", 
      "MatrixForm"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"locations", ":"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Iorigin", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"IaxisX", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"IaxisZ", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Quad1CenterPos", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "1"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Quad2CenterPos", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "2"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PayloadCenterPos", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "p"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"HangPoint1", "=", 
        RowBox[{"PayloadCenterPos", "+", 
         RowBox[{"Rp2I", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], 
             SubscriptBox["l", "p"]}], ",", 
            RowBox[{
             RowBox[{"+", 
              FractionBox["1", "2"]}], 
             SubscriptBox["h", "p"]}]}], "}"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"HangPoint2", "=", 
        RowBox[{"PayloadCenterPos", "+", 
         RowBox[{"Rp2I", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"+", 
              FractionBox["1", "2"]}], 
             SubscriptBox["l", "p"]}], ",", 
            RowBox[{
             RowBox[{"+", 
              FractionBox["1", "2"]}], 
             SubscriptBox["h", "p"]}]}], "}"}]}]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "labels", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PayloadLabel", " ", "=", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<Payload\>\"", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "p"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "4"}], "}"}], "+", 
         RowBox[{"Rp2I", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              SubscriptBox["l", "p"], "2"]}], ",", 
            FractionBox[
             SubscriptBox["h", "p"], "2"]}], "}"}]}]}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"down", " ", "and", " ", "right", " ", "offset"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Quad1Label", " ", "=", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<Quad1\>\"", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quad2Label", " ", "=", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<Quad2\>\"", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "i"], ",", 
           SubscriptBox["z", "i"]}], "}"}], " ", "/.", " ", 
         RowBox[{"i", "\[Rule]", "2"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"l1Label", "=", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(l\), \(1\)]\)\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            SubscriptBox["x", "p"]}], "2"], ",", 
          FractionBox[
           RowBox[{
            SubscriptBox["z", "1"], "+", 
            SubscriptBox["z", "p"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"l2Label", "=", 
      RowBox[{"Text", "[", 
       RowBox[{"\"\<\!\(\*SubscriptBox[\(l\), \(2\)]\)\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{
            SubscriptBox["x", "2"], "+", 
            SubscriptBox["x", "p"]}], "2"], ",", 
          FractionBox[
           RowBox[{
            SubscriptBox["z", "2"], "+", 
            SubscriptBox["z", "p"]}], "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"general", " ", "additions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spring", "[", 
       RowBox[{
        RowBox[{"r_:", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"n_:", " ", "20"}], ",", 
        RowBox[{"w_:", " ", "1"}], ",", 
        RowBox[{"origin_:", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{"Line", "@", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"r", "-", "origin"}], ",", 
              RowBox[{"-", 
               RowBox[{"Cross", "[", 
                RowBox[{"r", "-", "origin"}], "]"}]}]}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "-", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", "n"}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{"I", "^", "#"}], "]"}], " ", 
               RowBox[{"w", "/", 
                RowBox[{"Norm", "[", 
                 RowBox[{"r", "-", "origin"}], "]"}]}]}]}], "}"}]}], "+", 
           "origin"}], "]"}]}], "&"}], "@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"2", " ", "n"}], "+", "1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"elements", ":"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Iarrows", "=", 
      RowBox[{"{", 
       RowBox[{"Dashed", ",", 
        RowBox[{"Arrowheads", "[", "Small", "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"Iorigin", ",", "IaxisX"}], "}"}], "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"Iorigin", ",", "IaxisZ"}], "}"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Labels", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
       "PayloadLabel", ",", "Quad1Label", ",", "Quad2Label", ",", "l1Label", 
        ",", "l2Label"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Cabels", " ", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Arrowheads", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "Small"}], ",", "Small"}], "}"}], "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"HangPoint1", ",", "Quad1CenterPos"}], "}"}], "]"}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{"{", 
          RowBox[{"HangPoint2", ",", "Quad2CenterPos"}], "}"}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"spr1", "=", 
        RowBox[{"spring", "[", 
         RowBox[{
          RowBox[{"r", "/.", 
           RowBox[{"r", "\[Rule]", 
            RowBox[{"HangPoint1", "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}]}], ",", 
          RowBox[{"n", "/.", 
           RowBox[{"n", "\[Rule]", "8"}]}], ",", 
          RowBox[{"w", "/.", 
           RowBox[{"w", "\[Rule]", 
            RowBox[{"1", "/", "3."}]}]}], ",", 
          RowBox[{"origin", "/.", 
           RowBox[{"origin", "\[Rule]", 
            RowBox[{"Quad1Pos", "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}]}]}]}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"spr1", "=", 
      RowBox[{"spring", "[", 
       RowBox[{
        RowBox[{"r", "/.", 
         RowBox[{"r", "\[Rule]", "HangPoint1"}]}], ",", 
        RowBox[{"n", "/.", 
         RowBox[{"n", "\[Rule]", "8"}]}], ",", 
        RowBox[{"1", "/", "3."}], ",", 
        RowBox[{"origin", "/.", 
         RowBox[{"origin", "\[Rule]", "Quad1CenterPos"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spr2", "=", 
      RowBox[{"spring", "[", 
       RowBox[{"HangPoint2", ",", "8", ",", 
        RowBox[{"1", "/", "3"}], ",", "Quad2CenterPos"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PayloadBox", "=", 
      RowBox[{"{", 
       RowBox[{"Rotate", "[", 
        RowBox[{
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"HangPoint1", "-", 
            RowBox[{"Rp2I", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               SubscriptBox["h", "p"]}], "}"}]}]}], ",", "HangPoint2"}], 
          "]"}], ",", 
         RowBox[{"-", 
          SubscriptBox["\[Theta]", "p"]}]}], "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PayloadBoxRef", "=", 
      RowBox[{"{", 
       RowBox[{"Rotate", "[", 
        RowBox[{
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"HangPoint1", "-", 
            RowBox[{"Rp2I", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               SubscriptBox["h", "p"]}], "}"}]}]}], ",", "HangPoint2"}], 
          "]"}], ",", "0"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        SubscriptBox["l", "p"], ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PayloadBox", "=", 
        RowBox[{"{", 
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"PayloadCenterPos", "-", 
              RowBox[{"{", 
               RowBox[{
                FractionBox[
                 SubscriptBox["l", "p"], "2"], ",", 
                FractionBox[
                 SubscriptBox["h", "p"], "2"]}], "}"}]}], ",", 
             RowBox[{"PayloadCenterPos", "+", 
              RowBox[{"{", 
               RowBox[{
                FractionBox[
                 SubscriptBox["l", "p"], "2"], ",", 
                FractionBox[
                 SubscriptBox["h", "p"], "2"]}], "}"}]}]}], "]"}], ",", 
           SubscriptBox["\[Theta]", "p"]}], "]"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PayloadBox", "=", 
        RowBox[{"{", 
         RowBox[{"Circle", "[", 
          RowBox[{"PayloadCenterPos", ",", "1"}], "]"}], "}"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
        "Iarrows", ",", "Labels", ",", "Cabels", ",", "spr1", ",", "spr2", 
         ",", "PayloadBox"}], "}"}], "]"}]}]}]}], " ", "}"}]}]], "Input",
 CellChangeTimes->{{3.7120587404176054`*^9, 3.712058825931614*^9}, {
   3.712058919202143*^9, 3.7120590490405855`*^9}, {3.712059100100891*^9, 
   3.7120591145064383`*^9}, {3.712059152730131*^9, 3.712059171780089*^9}, {
   3.712059236916548*^9, 3.7120593400567846`*^9}, {3.7120594783412094`*^9, 
   3.7120595492856965`*^9}, {3.7120598977546854`*^9, 3.712059928526761*^9}, {
   3.7120599869427958`*^9, 3.7120600302216244`*^9}, {3.7120782655324416`*^9, 
   3.7120782666724424`*^9}, {3.712078311626141*^9, 3.712078369959116*^9}, 
   3.712099541724531*^9, {3.7120996926306906`*^9, 3.712099720225686*^9}, {
   3.7121002468207827`*^9, 3.712100248956828*^9}, {3.712100305823945*^9, 
   3.712100369160899*^9}, {3.7121004092388353`*^9, 3.712100433940072*^9}, {
   3.7121051887866883`*^9, 3.7121052473641014`*^9}, {3.71210530403001*^9, 
   3.7121053174555955`*^9}, {3.712105365520138*^9, 3.7121053732702713`*^9}, {
   3.712105415430535*^9, 3.7121054519614415`*^9}, {3.71210551472748*^9, 
   3.7121055214009027`*^9}, 3.7121055704901485`*^9, {3.712105658254139*^9, 
   3.712105785603138*^9}, {3.7121210405315056`*^9, 3.712121209206514*^9}, {
   3.712121245192358*^9, 3.7121212709504213`*^9}, {3.7121214123675914`*^9, 
   3.7121214521239333`*^9}, {3.7122797646431274`*^9, 
   3.7122797886511106`*^9}, {3.712279826640623*^9, 3.712279853632872*^9}, 
   3.71227991790884*^9, 3.7122799517633677`*^9, 3.7122800577551484`*^9, {
   3.7122800942922707`*^9, 3.712280138733817*^9}, {3.7122801900612373`*^9, 
   3.7122802533295913`*^9}, {3.7122802856071577`*^9, 3.7122803041124544`*^9}, 
   3.7122803652824306`*^9, {3.7122804713371334`*^9, 3.7122804802813244`*^9}, {
   3.7122807079922123`*^9, 3.7122807081962175`*^9}, {3.712280772525835*^9, 
   3.7122808020220623`*^9}, {3.712281072756978*^9, 3.71228110295236*^9}, 
   3.712281319020022*^9, {3.712281364178035*^9, 3.712281412576288*^9}, 
   3.7122814754673223`*^9, 3.7122815172387767`*^9, 3.712281551870166*^9, {
   3.7122819526400948`*^9, 3.7122820419791284`*^9}, 3.7122821148332787`*^9, {
   3.7122821622186246`*^9, 3.7122821705468054`*^9}, {3.7122822352059064`*^9, 
   3.7122822380939703`*^9}, {3.7122823039162846`*^9, 
   3.7122823282693977`*^9}, {3.7122824259582453`*^9, 3.71228244738344*^9}, 
   3.7122825566789217`*^9, {3.7122825936642284`*^9, 3.7122826889305735`*^9}, {
   3.7122827537902155`*^9, 3.712282824014408*^9}, {3.712282857363591*^9, 
   3.712282932790156*^9}, {3.7122833956274767`*^9, 3.7122833966194973`*^9}, {
   3.712283429093175*^9, 3.7122834291611767`*^9}, {3.712283565234461*^9, 
   3.7122835653304605`*^9}, {3.712283763837082*^9, 3.7122838427574167`*^9}, {
   3.712283907049592*^9, 3.712283922047177*^9}, {3.712283969798969*^9, 
   3.7122839698909707`*^9}, {3.712284320800973*^9, 3.712284359670287*^9}, 
   3.7122844270890512`*^9, {3.7122844664902463`*^9, 3.712284523307209*^9}, {
   3.712791797453519*^9, 3.712791817914074*^9}, {3.712791861288813*^9, 
   3.712791920516539*^9}, 3.7127919579203215`*^9, 3.7127922025109415`*^9, {
   3.71345928382347*^9, 3.713459290968206*^9}, {3.7134593213393335`*^9, 
   3.7134593594095526`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DrawSystem", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.712283956583717*^9, 3.7122839574117603`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       FractionBox["11", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["11", "2"]}], "}"}]}], "}"}], ",", 
   GraphicsBox[{
     {Dashing[{Small, Small}], Arrowheads[Small], ArrowBox[{{0, 0}, {0, 1}}], 
      ArrowBox[{{0, 0}, {1, 0}}]}, {
      InsetBox["\<\"Payload\"\>", {5, 5}, 
       NCache[{-3, Rational[9, 2]}, {-3, 4.5}]], 
      InsetBox["\<\"Quad1\"\>", {0, 10}, {-1, -1}], 
      InsetBox["\<\"Quad2\"\>", {10, 10}, {-1, -1}], 
      InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(1\\)]\\)\"\>", 
       NCache[{Rational[5, 2], Rational[15, 2]}, {2.5, 7.5}], {-2, 1}], 
      InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(2\\)]\\)\"\>", 
       NCache[{Rational[15, 2], Rational[15, 2]}, {7.5, 7.5}], {2, 1}]}, 
     {Arrowheads[{-Small, Small}], 
      ArrowBox[NCache[{{4, Rational[11, 2]}, {0, 10}}, {{4, 5.5}, {0, 10}}]], 
      ArrowBox[NCache[{{6, Rational[11, 2]}, {10, 10}}, {{6, 5.5}, {10, 
         10}}]]}, 
     LineBox[{{0., 10.}, {0.4991364395612199, 9.940204612943306}, {0.5, 
      9.4375}, {0.5008635604387801, 8.934795387056694}, {1., 8.875}, {
      1.49913643956122, 8.815204612943306}, {1.5, 8.3125}, {1.50086356043878, 
      7.809795387056694}, {2., 7.75}, {2.49913643956122, 7.690204612943306}, {
      2.5, 7.1875}, {2.50086356043878, 6.684795387056694}, {3., 6.625}, {
      3.49913643956122, 6.565204612943306}, {3.5, 6.0625}, {3.50086356043878, 
      5.559795387056694}, {4., 5.5}}], 
     LineBox[NCache[{{10, 10}, {
        Rational[39, 4] + 3 145^Rational[-1, 2], Rational[311, 32] + 
         Rational[-8, 3] 145^Rational[-1, 2]}, {
        Rational[19, 2], Rational[151, 16]}, {
        Rational[37, 4] - 3 145^Rational[-1, 2], Rational[293, 32] + 
         Rational[8, 3] 145^Rational[-1, 2]}, {9, Rational[71, 8]}, {
        Rational[35, 4] + 3 145^Rational[-1, 2], Rational[275, 32] + 
         Rational[-8, 3] 145^Rational[-1, 2]}, {
        Rational[17, 2], Rational[133, 16]}, {
        Rational[33, 4] - 3 145^Rational[-1, 2], Rational[257, 32] + 
         Rational[8, 3] 145^Rational[-1, 2]}, {8, Rational[31, 4]}, {
        Rational[31, 4] + 3 145^Rational[-1, 2], Rational[239, 32] + 
         Rational[-8, 3] 145^Rational[-1, 2]}, {
        Rational[15, 2], Rational[115, 16]}, {
        Rational[29, 4] - 3 145^Rational[-1, 2], Rational[221, 32] + 
         Rational[8, 3] 145^Rational[-1, 2]}, {7, Rational[53, 8]}, {
        Rational[27, 4] + 3 145^Rational[-1, 2], Rational[203, 32] + 
         Rational[-8, 3] 145^Rational[-1, 2]}, {
        Rational[13, 2], Rational[97, 16]}, {
        Rational[25, 4] - 3 145^Rational[-1, 2], Rational[185, 32] + 
         Rational[8, 3] 145^Rational[-1, 2]}, {6, Rational[11, 2]}}, {{10, 
        10}, {9.99913643956122, 9.497295387056694}, {9.5, 9.4375}, {
        9.00086356043878, 9.377704612943306}, {9, 8.875}, {8.99913643956122, 
        8.372295387056694}, {8.5, 8.3125}, {8.00086356043878, 
        8.252704612943306}, {8, 7.75}, {7.99913643956122, 
        7.247295387056694}, {7.5, 7.1875}, {7.00086356043878, 
        7.127704612943306}, {7, 6.625}, {6.99913643956122, 
        6.122295387056694}, {6.5, 6.0625}, {6.00086356043878, 
        6.002704612943306}, {6, 5.5}}]], 
     GeometricTransformationBox[
      RectangleBox[NCache[{4, Rational[9, 2]}, {4, 4.5}], 
       NCache[{6, Rational[11, 2]}, {6, 5.5}]], {{{1, 0}, {0, 1}}, 
       Center}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7127922084368663`*^9, 3.713459403744034*^9}]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.712792038216522*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}]}], "}"}], ",", 
   GraphicsBox[{{InsetBox["\<\"Payload\"\>", {5, 5}, {-2, 4}], 
      InsetBox["\<\"Quad1\"\>", {0, 10}, {-1, -1}], 
      InsetBox["\<\"\\!\\(\\*SubscriptBox[\\(l\\), \\(1\\)]\\)\"\>", 
       NCache[{Rational[5, 2], Rational[15, 2]}, {2.5, 7.5}], {-2, 1}]}, 
     {Arrowheads[{-Small, Small}], ArrowBox[{{5, 5}, {0, 10}}]}, 
     LineBox[{{0., 10.}, {0.5482022603955158, 9.923202260395517}, {0.625, 
      9.375}, {0.7017977396044842, 8.826797739604483}, {1.25, 8.75}, {
      1.798202260395516, 8.673202260395517}, {1.875, 8.125}, {
      1.951797739604484, 7.576797739604484}, {2.5, 7.5}, {3.0482022603955157`,
       7.423202260395516}, {3.125, 6.875}, {3.2017977396044843`, 
      6.326797739604484}, {3.75, 6.25}, {4.298202260395516, 
      6.173202260395516}, {4.375, 5.625}, {4.451797739604484, 
      5.076797739604484}, {5., 5.}}], CircleBox[{5, 5}]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.7127919752978363`*^9, 3.7127919846370225`*^9}, {
  3.712792023944066*^9, 3.7127920298499794`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"man", " ", "=", " ", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DrawSystem", "[", "\[Theta]", "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0"}], "}"}], ",", 
      RowBox[{"-", "90"}], ",", "90"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7122835963873177`*^9, 3.7122835976513467`*^9}, {
  3.712283988164075*^9, 3.712284031090217*^9}, {3.7122840654575925`*^9, 
  3.7122840704217243`*^9}, {3.712535196751369*^9, 3.712535197923143*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`\[Theta]$$ = 27., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`\[Theta]$$], 0}, -90, 90}}, Typeset`size$$ = {
    145., {2., 8.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`\[Theta]$537$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`\[Theta]$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`\[Theta]$$, $CellContext`\[Theta]$537$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Part[
        $CellContext`DrawSystem[$CellContext`\[Theta]$$], 3], 
      "Specifications" :> {{{$CellContext`\[Theta]$$, 0}, -90, 90}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{258., {51., 58.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.712283598215371*^9, {3.7122839994643188`*^9, 3.712284031658228*^9}, 
   3.7122840709537096`*^9, 3.712284369027264*^9, 3.7122845297073455`*^9, 
   3.7125351395053625`*^9, 3.712535198614602*^9, 3.7127918380904427`*^9, 
   3.7134594100672264`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(3\\)\[NoBreak] of \
\[NoBreak]\\!\\(DrawSystem[27.`]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.714570213404914*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{
   StyleBox[
    {Dashing[{Small, Small}], Arrowheads[Small], ArrowBox[{{0, 0}, {0, 1}}], 
     ArrowBox[{{0, 0}, {1, 0}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[{InsetBox[
      RowBox[{"\<\"Payload\"\>", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "p"], ",", 
         SubscriptBox["y", "p"]}], 
        ")"}]}], {3.1236496711538835`, 4.925933539650815}, \
{-3.0476752108720837`, 3.609645478412079}], InsetBox[
      RowBox[{"\<\"Quad1\"\>", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["y", "1"]}], 
        ")"}]}], {0.5925316827935105, 9.629667698254057}, {-1, -1}], InsetBox[
      RowBox[{"\<\"Quad2\"\>", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["y", "2"]}], 
        ")"}]}], {6.790453384868484, 9.654356518370452}, {-1, -1}], InsetBox[
      RowBox[{
       SubscriptBox["l", "1"], 
       "\"\<, \!\(\*SubscriptBox[\(k\), \(1\)]\)\>\""}], \
{2.253111798836038, 7.870332301745938}, {-2, 1}], InsetBox[
      RowBox[{
       SubscriptBox["l", "2"], ",", " ", 
       SubscriptBox["k", 
        "2"]}], {9.62323853001008, 7.7715770212803506`}, {2, 1}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    {Arrowheads[{-Small, Small}], 
     ArrowBox[{{3.9523247891279163`, 4.609645478412078}, {0, 10}}], 
     ArrowBox[{{5.316321509252913, 6.07235288165042}, {10, 10}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    LineBox[{{0., 10.}, {0.5158362772408681, 9.860204544894225}, {
     0.49404059864098954`, 9.32620568480151}, {0.472244920041111, 
     8.792206824708796}, {0.9880811972819791, 8.65241136960302}, {
     1.5039174745228472`, 8.512615914497244}, {1.4821217959229687`, 
     7.97861705440453}, {1.46032611732309, 7.444618194311815}, {
     1.9761623945639581`, 7.304822739206039}, {2.491998671804826, 
     7.165027284100264}, {2.4702029932049476`, 6.631028424007549}, {
     2.448407314605069, 6.097029563914834}, {2.9642435918459373`, 
     5.957234108809059}, {3.480079869086805, 5.8174386537032845`}, {
     3.4582841904869266`, 5.283439793610569}, {3.4364885118870485`, 
     4.749440933517853}, {3.9523247891279163`, 4.609645478412078}}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    LineBox[{{10., 10.}, {9.921454993600735, 9.499108782083187}, {
     9.414540188656614, 9.509044110206302}, {8.907625383712494, 
     9.518979438329419}, {8.829080377313229, 9.018088220412604}, {
     8.750535370913962, 8.517197002495791}, {8.243620565969842, 
     8.527132330618908}, {7.736705761025721, 8.537067658742023}, {
     7.658160754626456, 8.03617644082521}, {7.579615748227191, 
     7.535285222908396}, {7.0727009432830705`, 7.5452205510315125`}, {
     6.56578613833895, 7.555155879154628}, {6.487241131939685, 
     7.054264661237815}, {6.40869612554042, 6.553373443321001}, {
     5.901781320596299, 6.563308771444117}, {5.394866515652178, 
     6.573244099567233}, {5.316321509252913, 6.07235288165042}}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    GeometricTransformationBox[
     RectangleBox[NCache[{4, Rational[9, 2]}, {4, 4.5}], 
      NCache[{6, Rational[11, 2]}, {6, 5.5}]], {{{
      0.6819983600624985, -0.7313537016191705}, {0.7313537016191705, 
      0.6819983600624985}}, Center}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[InsetBox[
     StyleBox[Cell[TextData[Cell[BoxData[
       FormBox[
        SubscriptBox["l", "p"], TraditionalForm]],
       FontWeight->"Bold"]],
       GeneratedCell->False,
       CellAutoOverwrite->False,
       CellBaseline->Baseline,
       TextAlignment->Left],
      TextAlignment->Center,
      Background->GrayLevel[1.]], {4.3010779546020625`, 5.514797376994048}, {
     Left, Baseline},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[InsetBox[
     StyleBox[Cell[TextData[Cell[BoxData[
       FormBox[
        SubscriptBox["h", "p"], TraditionalForm]],
       FontWeight->"Bold"]],
       GeneratedCell->False,
       CellAutoOverwrite->False,
       CellBaseline->Baseline,
       TextAlignment->Left],
      TextAlignment->Center,
      Background->GrayLevel[1.]], {3.756180375417567, 3.7940853520885582`}, {
     Left, Baseline}, {0.5925316827935107, 0.6419093230263032}, {{1., 0.}, {
     0., 1.}},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    LineBox[{{5.049649792552232, 4.921375196399939}, {5.347386751762672, 
     4.8534635446212695`}}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    {Dashing[{Small, Small}], 
     LineBox[{{5.025696531342677, 4.949141420801594}, {8.185865506241402, 
      4.924452600685198}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    {Dashing[{Small, Small}], 
     LineBox[{{4.976318891109885, 4.973830240917989}, {6.902046860188794, 
      6.850180569764108}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    {EdgeForm[{GrayLevel[0.], Opacity[1.], AbsoluteThickness[1]}], EdgeForm[
     None], ArrowBox[{{7.272379161934738, 5.097274341499972}, {
      6.383581637744474, 6.134204786388617}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[InsetBox[
     StyleBox[Cell[TextData[Cell[BoxData[
       FormBox[
        SubscriptBox["\[Theta]", "p"], TraditionalForm]],
       FontWeight->"Bold"]],
       GeneratedCell->False,
       CellAutoOverwrite->False,
       CellBaseline->Baseline,
       TextAlignment->Left],
      TextAlignment->Center,
      Background->GrayLevel[1.]], {6.1860710768133025`, 5.245407262198345}, {
     Left, Baseline},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    {Dashing[{0, Small}], EdgeForm[{GrayLevel[0.], Opacity[1.], 
     AbsoluteThickness[1]}], EdgeForm[None], 
     ArrowBox[{{5.050385351459074, 5.023207881150782}, {5.025696531342677, 
      2.8259028907915145`}}]},
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[InsetBox[
     StyleBox[Cell[TextData[Cell[BoxData[
       FormBox[
        SubscriptBox["m", "p"], TraditionalForm]],
       FontWeight->"Bold"]],
       GeneratedCell->False,
       CellAutoOverwrite->False,
       CellBaseline->Baseline,
       TextAlignment->Left],
      TextAlignment->Center,
      Background->GrayLevel[1.]], {5.27258473250664, 2.480259409161965}, {
     Left, Baseline},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[InsetBox[
     StyleBox[Cell["I",
       GeneratedCell->False,
       CellAutoOverwrite->False,
       CellBaseline->Baseline,
       TextAlignment->Left],
      TextAlignment->Center,
      Background->GrayLevel[
       1.]], {0.31013188911098877`, 0.33233205903548857`}, {Left, Baseline},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"], 
   StyleBox[
    InsetBox["", {0.6804641908569329, 0.5298426199666597}, {Left, Baseline},
     Alignment->{Left, Top}],
    FontSize->18,
    FontWeight->"Bold"]},
  ImagePadding->{{0., 64.081633}, {1., 7.318367}},
  ImageSize->{486., Automatic},
  PlotRange->{{-0.20833333333333337`, 10.208333333333334`}, {-0.2, 10.2}},
  PlotRangePadding->Automatic]], "Input",
 CellChangeTimes->{{3.7130879307736807`*^9, 3.7130879483293133`*^9}, {
   3.713088074346204*^9, 3.7130880889083924`*^9}, {3.7130881939902816`*^9, 
   3.713088225104898*^9}, 3.7130882903426604`*^9, {3.7130883693850327`*^9, 
   3.713088464333742*^9}, {3.713088513716462*^9, 3.7130885431399565`*^9}, {
   3.7130900252370367`*^9, 3.7130901103985434`*^9}, 3.713460863281164*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ManToGif", "[", 
     RowBox[{"man_", ",", "name_String", ",", "step_Integer"}], "]"}], ":=", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"name", "<>", "\"\<.gif\>\""}], ",", 
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NotebookDirectory", "[", "]"}], ",", 
              "\"\<test.avi\>\""}], "}"}], "]"}], ",", "man"}], "]"}], ",", 
         "\"\<ImageList\>\""}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "1"}], ";;", "step"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"man2", "=", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"Sin", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "end"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"end", ",", "0", ",", 
         RowBox[{"2", " ", "Pi"}], ",", "0.1"}], "}"}]}], "]"}]}], ";"}], 
   "*)"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ManToGif", "[", 
   RowBox[{"man", ",", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<test\>\""}], "}"}], 
     "]"}], ",", "1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.712535157242189*^9, 3.7125351572521973`*^9}, {
  3.712535211837364*^9, 3.7125352158660307`*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"a", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"PayloadCenterPos", "-", 
     RowBox[{"Rp2I", ".", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         SubscriptBox["l", "p"], "2"], ",", 
        FractionBox[
         SubscriptBox["h", "p"], "2"]}], "}"}]}]}], ")"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"b", "=", 
  RowBox[{"(", 
   RowBox[{"PayloadCenterPos", "+", 
    RowBox[{"Rp2I", ".", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SubscriptBox["l", "p"], "2"], ",", 
       FractionBox[
        SubscriptBox["h", "p"], "2"]}], "}"}]}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"PayloadBox", "//", "N"}], ",", 
     RowBox[{"Rectangle", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7122830195313377`*^9, 3.7122830255635457`*^9}, {
   3.712283098320992*^9, 3.7122831402740126`*^9}, {3.7122832791856413`*^9, 
   3.712283286530023*^9}, 3.71228470145057*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.774520051230147`", ",", "3.904938909145821`"}], "}"}]], "Output",
 CellChangeTimes->{{3.712283014763232*^9, 3.712283026067528*^9}, {
   3.7122831036411057`*^9, 3.7122831081778193`*^9}, 3.7122831412380056`*^9, 
   3.7122832870140333`*^9, {3.712283416580231*^9, 3.7122834372453513`*^9}, {
   3.7122847038416586`*^9, 3.7122847282955694`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.225479948769853`", ",", "6.095061090854179`"}], "}"}]], "Output",
 CellChangeTimes->{{3.712283014763232*^9, 3.712283026067528*^9}, {
   3.7122831036411057`*^9, 3.7122831081778193`*^9}, 3.7122831412380056`*^9, 
   3.7122832870140333`*^9, {3.712283416580231*^9, 3.7122834372453513`*^9}, {
   3.7122847038416586`*^9, 3.712284728299568*^9}}],

Cell[BoxData[
 GraphicsBox[{
   GeometricTransformationBox[
    RectangleBox[{4., 4.5}, {6., 5.5}], {{{
     0.6184083953575541, -0.785856893175402}, {0.785856893175402, 
     0.6184083953575541}}, Center}], 
   RectangleBox[{4.774520051230147, 3.904938909145821}, \
{5.225479948769853, 6.095061090854179}]},
  ImageSize->{103.97196013931875`, Automatic},
  PlotRange->All]], "Output",
 CellChangeTimes->{{3.712283014763232*^9, 3.712283026067528*^9}, {
   3.7122831036411057`*^9, 3.7122831081778193`*^9}, 3.7122831412380056`*^9, 
   3.7122832870140333`*^9, {3.712283416580231*^9, 3.7122834372453513`*^9}, {
   3.7122847038416586`*^9, 3.712284728299568*^9}}]
}, Open  ]]
},
WindowSize->{1350, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 98, 1, 30, "Text"],
Cell[659, 23, 120, 2, 31, "Input"],
Cell[782, 27, 19078, 482, 1290, "Input"],
Cell[CellGroupData[{
Cell[19885, 513, 131, 2, 31, "Input"],
Cell[20019, 517, 4226, 86, 178, "Output"]
}, Open  ]],
Cell[24260, 606, 69, 1, 31, "Input"],
Cell[24332, 609, 1830, 43, 181, "Input"],
Cell[CellGroupData[{
Cell[26187, 656, 590, 14, 31, "Input"],
Cell[26780, 672, 1878, 37, 126, "Output"],
Cell[28661, 711, 479, 10, 21, "Message"]
}, Open  ]],
Cell[29155, 724, 7618, 195, 445, "Input"],
Cell[36776, 921, 1955, 56, 132, "Input"],
Cell[38734, 979, 271, 9, 10, "Text"],
Cell[CellGroupData[{
Cell[39030, 992, 1115, 34, 105, "Input"],
Cell[40148, 1028, 381, 6, 31, "Output"],
Cell[40532, 1036, 379, 6, 31, "Output"],
Cell[40914, 1044, 657, 13, 127, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
